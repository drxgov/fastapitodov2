<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToDo App</title>

    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="/templates/css/login.css">
    <link rel="stylesheet" href="/templates/css/modal.css">

    <!-- –®—Ä–∏—Ñ—Ç—ã -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link 
        href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&display=swap" 
        rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1 class="title">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ ToDo App</h1>
        <p>–î–æ–±—Ä–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫!</p>

        {% if user %}
            <p><strong>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:</strong> {{ user.username }}</p>

            <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
            <button class="add-task-btn" onclick="openModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</button>

            <!-- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á -->
            <div class="task-section">
                <h2>–í–∞—à–∏ –∑–∞–¥–∞—á–∏:</h2>

                {% if tasks %}
                                    {% for task in tasks %}
                    <div class="task-item">
                        <!-- –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ -->
                        <div class="task-title">
                            {% if task.is_completed %}
                                <s>{{ task.title or "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è" }}</s>
                            {% else %}
                                {{ task.title or "–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è" }}
                            {% endif %}
                        </div>

                        <!-- –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–≤—ã–Ω–µ—Å–µ–Ω–æ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã task-title) -->
                        {% if task.description %}
                            <div class="task-description">
                                {{ task.description }}
                            </div>
                        {% endif %}

                        <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                        <div class="task-actions">
                            <!-- –û—Ç–º–µ—Ç–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π -->
                            <form method="POST" action="/tasks/{{ task.id }}/complete" style="display:inline;">
                                <button type="submit" 
                                        class="complete-btn {% if task.is_completed %}done{% else %}not-done{% endif %}">
                                    {% if task.is_completed %}
                                        ‚úî –í—ã–ø–æ–ª–Ω–µ–Ω–æ
                                    {% else %}
                                        ‚úñ –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
                                    {% endif %}
                                </button>
                            </form>

                            <!-- –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É -->
                            <form method="POST" action="/tasks/{{ task.id }}/delete" style="display:inline;">
                                <button type="submit" class="delete-btn">üóë –£–¥–∞–ª–∏—Ç—å</button>
                            </form>
                        </div>
                    </div>
                {% endfor %}
                {% else %}
                    <p class="no-tasks">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–¥–∞—á. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!</p>
                {% endif %}
            </div>
        {% else %}
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, <a href="/login">–≤–æ–π–¥–∏—Ç–µ</a> –≤ —Å–∏—Å—Ç–µ–º—É.</p>
        {% endif %}
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 style="color: var(--lavender); margin-bottom: 1.5rem;">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É</h2>

            <form id="taskForm" method="POST" action="/tasks">
                <div class="form-group">
                    <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                    <input type="text" id="title" name="title" required placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ...">
                </div>

                <div class="form-group">
                    <label for="description">–û–ø–∏—Å–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
                    <textarea id="description" name="description" placeholder="–û–ø–∏—à–∏—Ç–µ –∑–∞–¥–∞—á—É..."></textarea>
                </div>

                <button type="submit" class="submit-btn">–°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É</button>
            </form>
        </div>
    </div>

    <!-- –ü–æ–¥–≤–∞–ª -->
    <footer>
        <p>¬© 2025 ToDo App created by drxgov</p>
    </footer>

    <!-- JS -->
    <script>
        function openModal() {
            document.getElementById('taskModal').style.display = 'flex'; // flex –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
        }

        function closeModal() {
            document.getElementById('taskModal').style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('taskModal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
